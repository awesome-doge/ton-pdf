# 4.1. TON

我們首先討論如何在 TON 生態系統內實現不同的區塊鏈和網路相關的應用程式和服務。 首先按順序進行簡單分類：

### 4.1.1	應用和服務

我們將交替使用 "application (應用)" 和 "service (服務)"。 但它們存在一種微妙且有些模糊的區別：應用程式通常直接向人類使用者提供某些服務，而服務通常被其他應用程式和服務利用。 例如，TON Storage 是一項服務，因為它旨在為其他應用程式和服務保留檔，即使人類用戶也可以直接使用它。 一個假設的 "區塊鏈中的 Facebook"(參見 2.9.13)或 Telegram messenger，如果通過 TON Network 提供(即實施為 "ton-service"；參見 4.1.6)，則更像是一個應用程式。即使某些 "機器人(bots)" 可能在沒有人為干預的情況下自動訪問它。

### 4.1.2	應用的位置：鏈上，鏈下或混合

為 TON 生態系統設計的服務或應用程式需要保留其資料並將資料處理到某處。 這就導致了以下的應用程式(和服務)的分類：

- 鏈上應用程式(參見 4.1.4)：所有資料和處理都在 TON Blockchain中。
- 鏈下應用程式(參見 4.1.5)：所有資料和處理都在 TON 區域鏈之外，在通過 TON Network 提供的伺服器上。
- 混合應用程式(參見 4.1.7)：部分(但不是全部)資料和處理都在 TON Blockchain中；其餘的是通過 TON Network 提供的鏈下伺服器。

### 4.1.3	中心化：中心化的和去中心化的或分散式應用程式

另一個分類標準是應用程式(或服務)是依賴於中心化伺服器集群，還是真正的  "分散式的
(參見 4.1.9)。 所有鏈上應用程式都自動去中心化和分發。 鏈下和混合應用可能表現出不同程度的中心化。現在讓我們更詳細地考慮上述可能性。

### 4.1.4 "鏈上" 應用程式：駐留在區塊鏈中的分散式應用程式或 "DApps" 
4.1.2 中提到的一種可能的方法是在 TON Blockchain中完全部署 "分散式應用程式"(通常簡稱為 "DApp")，作為智能合約或智慧合約的集合。所有資料將作為這些智慧合約的永久狀態的一部分保留，並且與項目的所有交互將通過發送到這些智慧合約或從這些智慧合約接收的(
TON Blockchain)消息來完成。
我們已經在 2.9.13 中討論過這種方法有其缺點和局限性，但也有其優點：這樣的分散式應用程式不需要運行伺服器或存儲其資料(它在 "區塊鏈" 中運行——即在驗證人的硬體上運行)
，並享有區塊鏈極高(拜占庭)的可靠性和可訪問性。這種分散式應用程式的開發人員不需要購買或租用任何硬體；他需要做的就是開發一些軟體(即智慧合約的代碼)。在那之後，她將有效地從驗證人那裡租用計算能力，並以 Grams 的形式支付它，無論是她自己支付還是讓用戶買單。

### 4.1.5	純粹的網路服務："ton-sites" "ton-services"

另一個極端的選擇是在某些伺服器上部署服務，並通過 3.1 中描述的 ADNL 協議將其提供給使用者，也可以使用一些更高級別的協議，如 3.1.9 中討論的 RLDP，可用於以任何自訂格式向五福發送 RPC 查詢並獲取這些查詢的答案。 這種情況中，該服務將完全處於鏈下，並將駐留在 TON Network 中，幾乎不使用 TON Blockchain。
TON Blockchain可能僅用於定位抽象位址或服務的位址，如 3.2.12 中所述，可能借助于諸如TON DNS(參見 4.3.1)之類的服務來促進域的翻譯——例如翻譯人類可讀的字串到抽象位址。
在某種程度上，ADNL 網路(即 TON Network )類似於隱形互聯網項目(I2P)，這種(幾乎)純粹的網路服務類似於所謂的 "eep-services"(即具有一個I2P -位址作為其入口點，並通過I2P網路提供給用戶端)。我們會說，駐留在 TON Network 中的這種純粹的網路服務是"ton-services"。
"eep-service" 可以實現 HTTP 作為其用戶端——伺服器協議；在 TON Network 環境中， "ton-services" 可能只是使用 RLDP(參見 3.1.9)資料包來傳輸 HTTP 查詢和回應。如果它使用 TON DNS 允許通過人類可讀的功能變數名稱查找其抽象位址，那麼對網站的類比就變得幾乎完美了。甚至可以編寫一個專門的流覽器，或者在用戶機器上本地運行的特殊代理("ton-proxy")，從用戶使用的普通 Web 流覽器接受任意 HTTP 查詢(一旦是本地 IP 位址和 TCP 埠)將代理輸入到流覽器的配置中，並通過 TON Network 將這些查詢轉發到服務的抽象位址。然後，用戶將具有類似于萬維網(WWW)的流覽體驗。
在I2P生態系統中，這種 "eep-services" 被稱為 "eep-sites"。人們也可以在 TON 生態系統中輕鬆創建 "ton-sites"。這在某種程度上得益於 TON DNS 等服務的存在，TON DNS 利用 TON Blockchain和 TON DHT 將(TON)功能變數名稱轉換為抽象位址。

### 4.1.6	Telegram Messenger 作為 ton-service；MTProto

RLDP。

順便一提，Telegram Messenger 35用於用戶端——伺服器交互的 MTProto36協定可以很容易地嵌入到 3.1.9 中討論的 RLDP 協議中，從而有效地將Telegram轉換為 ton-service。 由於TON Proxy 技術可以透明地為 ton-site 或 ton-service 的最終用戶開啟，實施的程度低於RLDP 和 ADNL 協議(參見 3.1.6)，這將使得Telegram能夠有效地不可阻止。當然，其他消息和社交網路服務也可能從這項技術中受益。

### 4.1.7	混合服務：部分鏈下，部分鏈上

有些服務可能採用混合方法：做大部分鏈下處理，但也有一些鏈上部分(例如向使用者登記他們的義務，反之亦然)。通過這種方式，部分狀態仍將保留在 TON Blockchain中(即不可變的公共帳本)，並且服務或其使用者的任何不當行為都可能受到智慧合約的懲罰。

---

[35] [https://telegram.org/](https://telegram.org/)    
[36] [https://core.telegram.org/mtproto](https://core.telegram.org/mtproto)

---

### 4.1.8	示例：保持文件在鏈下；TON Storage

TON Storage 提供了這種服務的一個例子。在最簡單的形式中，它允許用戶通過保持鏈上只存儲要存儲的檔的雜湊值來連結存儲檔，並且可能是一個其中一些其他方同意在預先商定的費用和時間內保留有問題的檔地智慧合約。實際上，檔可以被細分為一些小尺寸(例如，1 千位元組)的塊，通過諸如 Reed-Solomon 或噴泉碼的擦除代碼來增強，可以為增強的塊序列構造 Merkle tree hash。 這個 Merkle tree hash可以在智慧合約中發佈，而不是與檔的通常hash一起發佈。這有點讓人聯想到檔存儲在 torrent 中的方式。
一種更簡單的存儲檔形式是完全鏈下的：本質上是為新檔創建一個 "torrent"，並使用TON DHT 作為此 torrent 的 "分散式 torrent 追蹤器"(參見 3.2.10)。對於流檔，這實際上可能非常有效。但沒有獲得任何可用性的保證。例如，一個假設的 "區塊鏈 Facebook"(參見2.9.13)，可能會選擇將其用戶的個人資料照片完全脫離這種 "torrent"，這將可能會令普通
(不是特別受歡迎的)用戶失去其照片，或至少有可能無法長時間呈現這些照片。 TON Storage 技術主要是鏈下的，但使用鏈上智慧合約來強制存儲檔的可用性，可能更適合這項任務。

### 4.1.9	"霧服務"

到目前為止，我們已經討論了中心化混合服務和應用。雖然他們的鏈上元件以去中心化和分佈的方式處理，但他們的鏈下元件依賴於服務提供者的以通常的中心化方式控制的一些伺服器。算力可能來自某一家大公司提供的雲計算服務，而非某些專用伺服器。但是，這不會導致服務的鏈下元件的去中心化。
實現服務的鏈下元件的區中心方法在於創建一個市場，任何擁有所需硬體並願意租用其計算能力或磁碟空間的人都會向需要它們的人提供服務。
例如，可能存在一個註冊表(也可能稱為 "market" 或 "exchange")，其中所有對保持其他用戶的檔感興趣的節點都會發佈其聯繫資訊，以及它們的可用存儲容量，可用性策略和價格。需要這些服務的人可能會來查找，如果對方同意，則在區塊鏈中創建智慧合約並上傳檔以進行離線存儲。通過這種方式，像 TON Storage 這樣的服務變得真正分散，因為它不需要依賴任何集中的伺服器集群來存儲檔。

### 4.1.10	"霧計算(fog computing)" 平臺作為分散的混合服務

當想要執行某些特定計算(例如 3D 渲染或訓練神經網路)時，這種分散的混合應用的另一個例子就出現了，並且通常需要特定且昂貴的硬體。 那些擁有這種設備的人可能通過類似的"exchange" 提供他們的服務，而需要這些服務的人會租用相關設備，雙方的義務通過智慧合約登記。 這類似於 "霧計算" 平臺，如 Golem([https://golem.network/](https://golem.network/) )或 SONM( [https://sonm.io/](https://sonm.io/) )，的承諾交付。

### 4.1.11	示例：TON Proxy 是霧服務

TON 代理提供了霧服務的另一個示例，其中希望提供其服務(有或沒有補償)作為 ADNL 網路流量的隧道的節點可能會註冊，而需要它們的節點可能會根據價格、延遲、和頻寬選擇其中一個節點。之後就可以使用由 TON Payments 提供的支付通道來處理那些代理服務的小額支付，例如每收集 128 KiB 就付一次款。

### 4.1.12	示例：TON Payments 是一項霧服務

TON 支付平臺(參見 5)也是這種去中心化的混合應用的一個例子。
